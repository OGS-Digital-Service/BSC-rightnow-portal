// JavaScript Document
(function(){function r(f){function h(a,b){b=b?RightNow.Url.convertToSegment(RightNow.Url.convertToArray(1,b)):"";d.add({state:a},{url:p.getCurrentPage()+b})}function k(a){return function(){g||a.apply(this,arguments)}}var c={},e={},a={},b="",g=!1,d=new f.HistoryHTML5;d.on("change",function(a){var b;a.src===f.HistoryHTML5.SRC_POPSTATE&&(a=a.changed.state||a.changed[RightNow.Event.browserHistoryManagementKey],b=m.get(),g=!0,a?f.Object.each(a.newVal,function(a){q.ajaxCallback(a.response,a.data)}):f.Object.each(b,function(a){a.fire("reset").fire("send")}),g=!1)});return{enabled:!0,setCache:function(a,b,g){c[a]||(c[a]={});c[a][b]=g},checkCache:function(a,b){return c[a]?c[a][b]:null},restoreCache:k(function(c){if(f.Object.isEmpty(e)){var g=Object.keys(a)[0];g&&a[g]&&(a={newTransactionID:c});h(a,b+=c.friendly)}b=""}),addRequest:k(function(c,g){f.Object.isEmpty(e)&&(q.searchesPerformed++,a={},b="");e[g]=c}),addResponse:k(function(c,g){var d=e[g];if(d){var k=b+=d.friendly,d=f.merge(d,c);a[g]=d;delete e[g];f.Object.isEmpty(e)&&h(a,k)}}),clearCache:function(a){c[a]=null},doesCacheExist:function(a){return c[a]?!0:!1}}}var l,q,p,m;"pushState"in window.history?YUI().use("history-html5",function(f){l=r(f)}):l={enabled:!1};q=function(){function f(a,b,c){var d="undefined"===typeof c;a&&!d&&l.addResponse({response:a,data:b},c);l.setCache(b.searchSource,b.cacheKey,a);c=m.get(b.searchSource);d&&(c.once("send",function(){return!1}).fire("send",b.allFilters),a.fromHistoryManager=!0);c.fire("response",new RightNow.Event.EventObject(null,{data:a,filters:b.allFilters}))}function h(a,b,c,d){a=RightNow.Ajax.makeRequest(a,b,{successHandler:f,failureHandler:function(a){var b=a.suggestedErrorMessage||RightNow.Interface.getMessage("THERE_PROB_REQ_ACTION_COULD_COMPLETED_MSG");403===a.status&&void 0!==a.responseText&&(b=a.responseText);RightNow.UI.Dialog.messageDialog(b,{icon:"WARN",exitCallback:function(){window.location.reload(!0)}})},json:!0,data:c,timeout:1E4});l.addRequest(d,a.id+"")}function k(a,b,c,d){var f=["keyword"].concat(a.filters||[]),s=f.length,h,k,l={};c=RightNow.Lang.cloneObject(c);a.params&&(c=e.mix(c,a.params));if(b&&b.allFilters)for(a=0;a<s;a++)h=f[a],(k=b.allFilters[h])&&k.filters&&k.filters.data&&!c[h]&&("keyword"!==h||d||(h="kw"),l[h]=c[h]=k.filters.data);c.page&&!l.page&&(l.page=c.page);return{filtersToInclude:l,params:c}}function c(a,b){b&&1!==b||(a=RightNow.Url.addParameter(a,"search","1"));return a}var e=YUI();return{searchesPerformed:0,go:function(a,b,g,d,e){if("report"===d.type){if("undefined"===typeof b)throw Error("No search filters have been defined for report "+d.id);RightNow.Event.fire("evt_searchRequest",new RightNow.Event.EventObject(this,{filters:b}));if(!l.enabled||!0===a.newPage||a.reportPage&&!RightNow.Url.isSameUrl(a.reportPage))if(g=RightNow.Url,d=a.reportPage||p.getCurrentPage(),e=a.target||"_self",!a.page&&b.allFilters.page&&(a.page=1,b.allFilters.page=1),d=g.convertSearchFiltersToParms(d,b.allFilters,0),d=g.addParameter(d,"session",g.getSession()),d=c(d,b.allFilters.page),a.popupWindow){b=window.screenX||window.screenLeft;g=window.screenY||window.screenTop;var f;f=b+document.body.clientWidth;e=screen.width*a.width/100;a=screen.height*a.height/100;f=b>screen.width-f?b-e-15:f+15;var n=window.screenY?window.screenY:window.screenTop;0>f&&(f=b+100);0>n&&(n=g+100);window.open(d,"_blank","scrollbars=1,resizable=1,left="+f+",top="+n+",width="+e+"px,height="+a+"px")}else window.open(d,e);else a.page?delete b.allFilters.search:b.allFilters.page=1,a=d.id,d=d.type+d.id,g=p.buildReportRequestParameters(a,b.allFilters,b.format,b.token,0),e=RightNow.Url.convertSearchFiltersToParms("",b.allFilters,""),f=g.sf,1===f.page&&(f.search=1),f=RightNow.JSON.stringify(f),n=l.checkCache(d,f),e={friendly:e,response:n,data:{allFilters:b,cacheKey:f,key:d}},n?(l.restoreCache(e),m.get(d).fire("response",new RightNow.Event.EventObject(null,{data:n,filters:b}))):h("/ci/ajaxRequest/getReportData",{filters:f,report_id:a,r_tok:g.token,format:RightNow.JSON.stringify(g.fmt)},{searchSource:d,allFilters:b,cacheKey:f},e)}else if(g&&"object"===typeof g&&d.id)if(RightNow.Event.fire("evt_searchRequest",new RightNow.Event.EventObject(this,{filters:b})),l.enabled&&!0!==a.newPage){a=e.endpoint;b=k(e,b,g,!0);g=b.filtersToInclude;b=b.params;if(!a)throw Error("An endpoint hasn't been specified");d=d.type+d.id;e=RightNow.JSON.stringify(b);f=l.checkCache(d,e);g={key:d,friendly:RightNow.Url.convertToSegment(g)};f?(l.restoreCache(g),m.get(d).fire("response",new RightNow.Event.EventObject(null,{data:f,filters:b}))):h(a,b,{searchSource:d,allFilters:b,cacheKey:e},g)}else a=RightNow.Url,d=p.getCurrentPage(),b=k(e,b,g,!1).filtersToInclude,d+=a.convertToSegment(b),d=a.addParameter(d,"session",a.getSession()),d=c(d,b.page),window.open(d,"_self")},ajaxCallback:f}}();p={buildReportRequestParameters:function(f,h,k,c,e){var a=RightNow.Lang.cloneObject(h),b;for(b in a)a.hasOwnProperty(b)&&(a[b].filters&&(a[b].filters.report_id=parseInt(f,10)),a[b].data&&delete a[b].data);k||(k={});k.urlParms=RightNow.Url.buildUrlLinkString(h,k.parmList);return{c:e,id:f,sf:a,fmt:k,token:c}},getCurrentPage:function(){var f=window.location,h=f.pathname,f=f.origin||f.protocol+"//"+f.host;return"/"===h||"/app"===h||"/app/"===h?f+"/app/"+RightNow.Interface.getConfig("CP_HOME_URL"):h.split("/").slice(0,RightNow.Url.getParameterSegment()-1).join("/")}};m=function(){function f(c){if(!c||!c.length||2>c.length)throw Error("You're doing it wrong");this.sources=c;this.multiple=!0}var h={},k=RightNow.EventProvider.extend({overrides:{constructor:function(c,e){this.parent();this.Y=c;delete this.data;delete this.baseDomID;delete this.baseSelector;this.searchSource=e;this.instanceID=e.id;this._addEventHandler("search",{pre:function(a){this._params||(this._params={});a instanceof RightNow.Event.EventObject&&(this._originalEventObject=RightNow.Lang.cloneObject(a),this._collectSearchFilters(a),this._params.newPage=a.filters.newPage)},during:function(a){a instanceof RightNow.Event.EventObject&&this._collectSearchFilters(a)},post:function(){var a,b;if(this._excludedFilters)for(a=0;a<this._excludedFilters.length;a++)b=this._excludedFilters[a],this._respondingFilters&&!this._respondingFilters[b]&&(b=this._filters.allFilters[b])&&b.filters&&(b.filters.data[0]?b.filters.data[0]=null:b.filters.data=null);this.fire("send",this._filters,this._params)}})._addEventHandler("send",{pre:function(a){this._originalEventObject||(this._originalEventObject={filters:{page:1,newPage:!1}});this._eventCancelled=!1},during:function(a){!1===a&&(this._eventCancelled=!0)},post:function(a){this._eventCancelled||(this._excludedFilters=[],q.go(this._originalEventObject.filters,this._filters,this._params,this.searchSource,this))}})._addEventHandler("setInitialFilters",{post:function(a){this._setInitialFilters(a)}})._addEventHandler("appendFilter",{post:function(a){this._originalEventObject||(this._originalEventObject=RightNow.Lang.cloneObject(a));this._mergeFilters(a)}})._addEventHandler("excludeFilterFromNextSearch",{post:function(a){this._excludedFilters||(this._excludedFilters=[]);this._excludedFilters.push(a.data.name)}})._addEventHandler("reset").on("reset",function(){this._filters=RightNow.Lang.cloneObject(this._initialFilters);if(this._params&&this._filters&&this._filters.allFilters){var a=this._filters.allFilters;this._initialParams&&(this._params=RightNow.Lang.cloneObject(this._initialParams));this.Y.Object.each(this._params,function(b,c,d){a[c]&&a[c].filters&&"data"in a[c].filters&&(d[c]=a[c].filters.data)})}},this)}},clearCache:function(){l.enabled&&l.clearCache(this.searchSource.type+this.searchSource.id)},doesCacheExist:function(){return l.enabled?l.doesCacheExist(this.searchSource.type+this.searchSource.id):!1},_setFilters:function(c){this._filters=c},_setInitialFilters:function(c){c instanceof RightNow.Event.EventObject&&(this.Y.Object.isEmpty(c.filters)||(this._filters=c.filters,this._initialFilters=RightNow.Lang.cloneObject(c.filters)),this.Y.Object.isEmpty(c.data)||(this._params=c.data,this._initialParams=RightNow.Lang.cloneObject(c.data)))},_mergeFilters:function(c){this._filters.allFilters=this.Y.mix(this._filters.allFilters,c.filters,!0,null,0,!0)},_collectSearchFilters:function(c){c=new RightNow.Event.EventObject({instanceID:c.w_id},RightNow.Lang.cloneObject(c));c.filters.searchName?(this._respondingFilters||(this._respondingFilters={}),this._respondingFilters[c.filters.searchName]=!0,this._filters||(this._filters={}),this._filters.allFilters||(this._filters.allFilters={}),this._filters.allFilters[c.filters.searchName]=c):"generic"===this.searchSource.type&&(this._params=this.Y.mix(this._params||{},c.data,!0))}});f.prototype={_invoke:function(c,e,a,b){for(var f=0;f<this.sources.length;f++)this.sources[f][c](e,a,b);return this},on:function(c,e,a){return this._invoke("on",c,e,a)},fire:function(c,e,a){return this._invoke("fire",c,e,a)}};return{multipleSourcesWrapper:f,get:function(c){return"undefined"===typeof c?h:h[c]},add:function(c,e){if(c&&e instanceof k&&!h[c])return h[c]=e},getSearchSources:function(c,e){var a=c?(c+"").split(","):[],b=e?(e+"").split(","):[],f=[],d;for(d=0;d<a.length;d++)f.push({type:"report",id:a[d]});for(d=0;d<b.length;d++)f.push({type:"generic",id:b[d]});return{report:a,source:b,keys:f}},searchSource:k,findNamedSource:function(c,e){if(e){this.findNamedSource.findSource||(this.findNamedSource.findSource=function(a,b){if(b.multiple)for(var c=0;c<b.sources.length;c++){if(b.sources[c].instanceID===a)return b.sources[c]}else if(b.instanceID===a)return b});this.findNamedSource.warning||(this.findNamedSource.warning=function(a){RightNow.UI.DevelopmentHeader&&RightNow.UI.DevelopmentHeader.addJavascriptWarning(RightNow.Text.sprintf(RightNow.Interface.getMessage("PCT_D_SRCH_SRC_ID_RPT_ID_SRC_ID_LBL"),a))});var a=[],b=[];if("string"===typeof e||"number"===typeof e){e=(e+"").split(",");if(1<e.length){for(var g=0,d;g<e.length;g++)(d=this.findNamedSource.findSource(e[g],c))?a.push(d):b.push(e[g]);b.length&&this.findNamedSource.warning(b.join(", "));if(a.length)return 1<a.length?new f(a):a[0]}else if(a=this.findNamedSource.findSource(e[0],c))return a;!b.length&&this.findNamedSource.warning(e[0]);return c}if("object"===typeof e){for(g in e)e.hasOwnProperty(g)&&((d=this.findNamedSource.findSource(g,c))?(d=YUI().mix(d,e[g]),a.push(d)):b.push(g));b.length&&this.findNamedSource.warning(b.join(", "));if(a.length)return 1<a.length?new f(a):a[0]}}if(!c)throw Error("The widget extending from RightNow.SearchFilter doesn't have report_id or source_id attributes.");return c}}}();RightNow.SearchFilter=RightNow.Widgets.extend({constructor:function(){for(var f=m.getSearchSources(this.data.attrs.report_id,this.data.attrs.source_id),h=[],k=0,c,e;k<f.keys.length;k++)e=f.keys[k],c=m.get(e.type+e.id),c||(c=new m.searchSource(this.Y,e),m.add(e.type+e.id,c)),h.push(c);1<h.length&&(c=new m.multipleSourcesWrapper(h));this.searchSource=function(a){return m.findNamedSource(c,a)}}});RightNow.ResultsDisplay=RightNow.SearchFilter})();
RightNow.ProductCategory=RightNow.EventProvider.extend({initializeTreeView:function(a){this.dataType=a;this.displayField||(this.displayField=this.Y.one(this.baseSelector+"_"+this.dataType+"_Button"));this.buildPanel();this.Y.one(this.baseSelector+"_LinksTrigger").on("click",this.showAccessibleView,this);RightNow.Event.on("evt_accessibleTreeViewGetResponse",this.getAccessibleTreeViewResponse,this);RightNow.Event.on("evt_menuFilterGetResponse",this.getSubLevelResponse,this);this.data.js.hierData&&this.data.js.hierData[0]&&this.data.js.hierData[0].length&&this.buildTree()},buildPanel:function(){this.dropdown=new this.Y.RightNowTreeViewDropdown({srcNode:this.Y.one(this.baseSelector+"_TreeContainer").removeClass("rn_Hidden"),render:this.Y.one(this.baseSelector),trigger:this.displayField,visible:!1});this.dropdown.once("show",this.Y.bind(this.buildTree,this,!1));this.dropdown.on("show",function(){this.tree.focusOnSelectedNode()},this)},buildTree:function(a){if(!this.tree||a){this.tree&&this.tree.clear();this.data.js.linkingOn&&"Category"===this.dataType&&this.data.js.link_map&&(this.data.js.hierData=this.data.js.link_map);this.tree=new this.Y.RightNowTreeView({hierarchyData:this.data.js.hierData||this.data.js.hierDataNone,contentBox:this.Y.one(this.baseSelector+"_Tree").setStyles({"overflow-y":"auto",display:"block"})});this.tree.render();this.data.js.hierData&&this.data.js.hierDataNone&&delete this.data.js.hierData;this.tree.on("enterKey",this.selectNode,this);this.tree.on("dynamicNodeExpand",this.getSubLevelRequest,this);if(this.data.attrs.show_confirm_button_in_dialog)this.dropdown.set("confirmButton",this.Y.one(this.baseSelector+"_"+this.data.js.data_type+"_ConfirmButton")),this.dropdown.set("cancelButton",this.Y.one(this.baseSelector+"_"+this.data.js.data_type+"_CancelButton")),this.dropdown.on("confirm",function(){this.selectNode(this.tree.getFocusedNode())},this),this.Y.one(this.baseSelector+"_TreeContainer").setStyle("display","block");else this.tree.on("click",this.selectNode,this);this.tree.get("value")&&this.displaySelectedNodesAndClose(!1);this.dropdown.set("treeView",this.tree)}},pruneNonPermissionedAccessibleNodes:function(a){this.checkIdsAreValid("readableProdcatIds");if(0===this.data.js.readableProdcatIds.length)return a;var b=[];this.Y.Array.each(a,function(a){(this.checkPermissionsOnNode(a[1])||this.hasPermissionedAccessibleChildren(a))&&b.push(a)},this);return b},hasPermissionedAccessibleChildren:function(a){return this.checkForPermissionedChildren(a[1],a.level+1)},hasPermissionedChildren:function(a,b){return a.hasChildren?this.checkForPermissionedChildren(a.id,b):!1},checkForPermissionedChildren:function(a,b){if(!(this.data&&this.data.js&&this.data.js.readableProdcatIds&&this.Y.Lang.isArray(this.data.js.readableProdcatIds)))throw Error("Widget does not have this.data.js.readableProdcatIds attribute set, or its value is not an array");if(0===this.data.js.readableProdcatIds.length)return!0;var c="Level"+b;return this.Y.Array.some(this.data.js.permissionedProdcatList,function(b){if(b[c]===a&&b.ID!==a)return!0},this)},checkPermissionsOnNode:function(a){var b=this.data.js.permissionedProdcatIds&&this.Y.Lang.isArray(this.data.js.permissionedProdcatIds),c=this.data.js.readableProdcatIds&&this.Y.Lang.isArray(this.data.js.readableProdcatIds);if(!b&&!c)throw Error("Widget has neither this.data.js.readableProdcatIds or this.data.js.permissionedProdcatIds set, or their values are not an array.");return b&&0===this.data.js.permissionedProdcatIds.length||c&&0===this.data.js.readableProdcatIds.length?!0:b?this.isPermissionedNode(a):this.isReadableNode(a)},isPermissionedNode:function(a){return this.userHasFullProdcatPermissions()?!0:-1!==this.Y.Array.indexOf(this.data.js.permissionedProdcatIds,parseInt(a,10))},userHasFullProdcatPermissions:function(){this.checkIdsAreValid("permissionedProdcatIds");return"None"===this.data.attrs.verify_permissions||0===this.data.js.permissionedProdcatIds.length},isReadableNode:function(a){this.checkIdsAreValid("readableProdcatIds");return 0===this.data.js.readableProdcatIds.length?!0:-1!==this.Y.Array.indexOf(this.data.js.readableProdcatIds,parseInt(a,10))},disableNonPermissionedAccessibleNodes:function(a){this.checkIdsAreValid("readableProdcatIds");if(0!==this.data.js.readableProdcatIds.length&&this.data.attrs.label_selection_not_valid){var b;this.Y.Array.each(a,function(a){this.checkPermissionsOnNode(a[1])||(b=this.Y.one(this.baseSelector+"_AccessibleLink_"+a[1]),b.setHTML(RightNow.Text.sprintf(this.data.attrs.label_selection_not_valid,b.getHTML())))},this)}},disableNonPermissionedNodes:function(a){this.checkIdsAreValid("readableProdcatIds");0!==this.data.js.readableProdcatIds.length&&this.Y.Array.each(a,function(a){this.checkPermissionsOnNode(a.id)||this.Y.one("#ygtvlabelel"+this.tree.getNodeByValue(a.id).index).addClass("rn_Disabled")},this)},onAccessibleLinkClick:function(a){var b=a.valueChain[a.valueChain.length-1];this.tree.expandAndCreateNodes(a.valueChain);this.checkPermissionsOnNode(b)&&this.dialog.hide()},showAccessibleView:function(a){a.halt();this._eo||(this._eo=new RightNow.Event.EventObject(this));"Category"===this.dataType&&this.data.js.linkingOn&&(this._eo.data.linkingProduct=RightNow.UI.Form.currentProduct);this.dialog?this.displayAccessibleDialog():RightNow.Event.fire("evt_accessibleTreeViewRequest",this._eo)},getAccessibleTreeViewResponse:function(a,b){b=b[0];if(b.w_id===this._eo.w_id&&b.data.hm_type===this._eo.data.hm_type){var c=b.data.accessibleLinks;if("prod_chain"in c){c=[];delete b.data.accessibleLinks.prod_chain;for(var d in b.data.accessibleLinks)c.push(b.data.accessibleLinks[d])}c.unshift({0:this.data.attrs.label_all_values,1:0,hier_list:0,level:0});c=this.pruneNonPermissionedAccessibleNodes(c);this.createAccessibleDialog(c);this.buildTree();this.displayAccessibleDialog();this.disableNonPermissionedAccessibleNodes(c)}},createAccessibleDialog:function(a){this.dialog&&this.dialog.destroy();var b="Product"===this.dataType?RightNow.Interface.getMessage("SELECT_BELOW_USING_LINKS_PROVIDED_MSG"):RightNow.Interface.getMessage("CATEGORY_BELOW_USING_LINKS_PROVIDED_MSG"),c=RightNow.Interface.getMessage("DEPTH_ANNOUNCED_NAVIGATE_THROUGH_LIST_MSG");this.dialog=new this.Y.RightNowTreeViewDialog({id:"rn_"+this.instanceID,hierarchyData:a,contentBox:this.Y.one(this.baseSelector+"_Links"),dismissLabel:RightNow.Interface.getMessage("CANCEL_CMD"),titleLabel:this.data.attrs.label_nothing_selected,introLabel:b+" "+c,selectionPlaceholderLabel:RightNow.Interface.getMessage("SELECTION_PCT_S_ACTIVATE_LINK_JUMP_MSG"),levelLabel:this.data.attrs.label_level,noItemSelectedLabel:this.data.attrs.label_all_values});this.dialog.on("selectionMade",this.onAccessibleLinkClick,this);this.dialog.render()},displayAccessibleDialog:function(){this.dialog.set("selectedValue",this.tree.get("value"));this.dialog.set("selectedLabels",this.tree.get("labelChain"));this.dialog.show();var a=this.Y.one("p.rn_Intro a");a&&a.focus()},displaySelectedNodesAndClose:function(a){this._eo||(this._eo=new RightNow.Event.EventObject(this));this._eo.data.hierChain=this.tree.get("valueChain");RightNow.Event.fire("evt_productCategoryFilterSelected",this._eo);delete this._eo.data.hierChain;var b=this.tree.get("valueChain"),c=this.data.attrs.label_nothing_selected,d=this.data.attrs.label_nothing_selected;this.dropdown.hide();b[0]&&(c=this.tree.get("labelChain").join("<br>"),d=this.data.attrs.label_screen_reader_selected+c);this.dropdown.set("triggerText",c);this.Y.all(this.baseSelector+"_TreeDescription").setHTML(d);if(a&&!this.dialog)try{this.dropdown.get("trigger").focus()}catch(e){}},selectNode:function(a){this.displaySelectedNodesAndClose(!0)},getSubLevelRequest:function(a){if(!this._nodeBeingExpanded){this._nodeBeingExpanded=!0;if(a=this.getSubLevelRequestEventObject(a))"Product"===this.dataType&&(RightNow.UI.Form.currentProduct=a.data.value),this._requesting=a.data.value,RightNow.Event.fire("evt_menuFilterRequest",a);this._nodeBeingExpanded=!1;this._eo.data.link_map&&delete this._eo.data.link_map}},getSubLevelRequestEventObject:function(a){return new RightNow.Event.EventObject(this,{data:{level:a.depth+1,value:a.value,label:a.label,cache:{}}})},getSubLevelResponse:function(a,b){this.data.js.link_map&&delete this.data.js.link_map;var c=a.data.level,d=a.data.hier_data,e,d=this.groomProdcats(d);this.buildTree();!a.data.reset_linked_category&&this.getSubLevelRequestEventObject._origRequest&&this.getSubLevelRequestEventObject._origRequest[b]?e=this.getSubLevelRequestEventObject._origRequest[b]:a.data.reset_linked_category&&(this.tree.clear(this.data.attrs.label_all_values),this.dialog=null,this.selectNode(this.tree.getRoot()));7>c&&this.insertChildrenForNode(d,e);0===d.length&&this.displaySelectedNodesAndClose()},insertChildrenForNode:function(a,b){this.tree.insertChildHierarchyData(a,b)},removeNonReadableProdcats:function(a){this.checkIdsAreValid("readableProdcatIds");var b=this.data;return this.Y.Array.filter(a,function(a){if(-1!==this.Y.Array.indexOf(b.js.readableProdcatIds,a.id))return a},this)},updateProdcatsHasChildrenAttribute:function(a){this.checkIdsAreValid("readableProdcatIdsWithChildren");var b=this.data;return this.Y.Array.map(a,function(a){a.hasChildren=-1!==this.Y.Array.indexOf(b.js.readableProdcatIdsWithChildren,a.id)?!0:!1;return a},this)},groomProdcats:function(a){!1!==this.data.attrs.verify_permissions&&"None"!==this.data.attrs.verify_permissions&&0<this.data.js.readableProdcatIds.length&&(a=this.removeNonReadableProdcats(a),a=this.updateProdcatsHasChildrenAttribute(a));return a},checkIdsAreValid:function(a){if(!(this.data&&this.data.js&&this.data.js[a]&&this.Y.Lang.isArray(this.data.js[a])))throw Error("Widget does not have this.data.js."+a+" attribute set, or its value is not an array");}});
RightNow.Widgets.AdvancedSearchDialog=RightNow.SearchFilter.extend({overrides:{constructor:function(){this.parent();this.Y.one(this.baseSelector+"_TriggerLink").on("click",this._openDialog,this);}},_openDialog:function(evt){if(!this._dialog){var dialogDiv=this.Y.one(this.baseSelector+"_DialogContent");if(dialogDiv){var buttons=[{text:this.data.attrs.label_search_button,handler:{fn:this._performSearch,scope:this}},{text:this.data.attrs.label_cancel_button,handler:{fn:this._cancelFilters,scope:this}}];this._dialog=RightNow.UI.Dialog.actionDialog(this.data.attrs.label_dialog_title,dialogDiv,{buttons:buttons});this.Y.one("#"+this._dialog.get('id')).addClass("rn_AdvancedSearchDialog");RightNow.UI.show(dialogDiv);this._dialog.hideEvent.subscribe(function(){if(evt.target.focus){evt.target.focus();}},null,this);}}
this._dialogClosed=false;this._dialog.show();this._dialog.hideEvent.subscribe(this._cancelFilters,null,this);},_performSearch:function(){this._closeDialog();var searchPage=this.data.attrs.report_page_url;this.searchSource().fire("search",new RightNow.Event.EventObject(this,{filters:{report_id:this.data.attrs.report_id,reportPage:searchPage,newPage:top!==self||(searchPage!==""&&searchPage!=="{current_page}")||!RightNow.Url.isSameUrl(searchPage)}}));},_cancelFilters:function(){if(this._dialogClosed)return;this._closeDialog();this.searchSource().fire("reset",new RightNow.Event.EventObject(this,{data:{name:"all"},filters:{report_id:this.data.attrs.report_id}}));},_closeDialog:function(){this._dialogClosed=true;if(this._dialog)
this._dialog.hide();}});
RightNow.Widgets.KeywordText=RightNow.SearchFilter.extend({overrides:{constructor:function(){this.parent();this._textElement=this.Y.one(this.baseSelector+"_Text");this.data.js.initialValue=this._decoder(this.data.js.initialValue);if(this._textElement){this._searchedOn=this._textElement.get("value");if(this._searchedOn!==this.data.js.initialValue)
this._textElement.set("value",this.data.js.initialValue);this._setFilter();this._textElement.on("change",this._onChange,this);this.searchSource().on("keywordChanged",this._onChangedResponse,this).on("search",this._onGetFiltersRequest,this).on("reset",this._onResetRequest,this);this.searchSource(this.data.attrs.report_id).on("response",this._onChangedResponse,this);if(this.data.attrs.initial_focus)
this._textElement.focus();}}},_onChange:function(evt){this._eo.data=this._textElement.get("value");this._eo.filters.data=this._textElement.get("value");this.searchSource().fire("keywordChanged",this._eo);},_onGetFiltersRequest:function(type,args){this._eo.filters.data=this.Y.Lang.trim(this._textElement.get("value"));this._searchedOn=this._eo.filters.data;return this._eo;},_setFilter:function(){this._eo=new RightNow.Event.EventObject(this,{filters:{searchName:this.data.js.searchName,data:this.data.js.initialValue,rnSearchType:this.data.js.rnSearchType,report_id:this.data.attrs.report_id}});},_onChangedResponse:function(type,args){var data=RightNow.Event.getDataFromFiltersEventResponse(args,this.data.js.searchName),newValue=(data===null)?this.data.js.initialValue:data;newValue=this._decoder(newValue);if(this._textElement.get("value")!==newValue)
this._textElement.set("value",newValue);},_onResetRequest:function(type,args){if(!args[0]||args[0].data.name===this.data.js.searchName){this._textElement.set('value',this.data.js.initialValue);}
else if(args[0].data.name==='all'){this._textElement.set('value',this._searchedOn);}},_decoder:function(value){if(value)
return value.replace(/&gt;/g,'>').replace(/&lt;/g,'<').replace(/&#039;/g,"'").replace(/&quot;/g,'"');return value;}});
RightNow.Widgets.SearchButton=RightNow.SearchFilter.extend({overrides:{constructor:function(){this.parent();this._requestInProgress=false;this._searchButton=this.Y.one(this.baseSelector+"_SubmitButton");if(this._searchButton){this._searchButton.on("click",this._startSearch,this);this.searchSource().on("response",this._enableClickListener,this);}}},_startSearch:function(evt){if(this._requestInProgress)return;if(!this.data.attrs.popup_window&&(!this.data.attrs.report_page_url||(this.data.attrs.target==='_self')))
this._disableClickListener();if(this.Y.UA.ie){this._parentForm=this._parentForm||this.Y.one(this.baseSelector).ancestor("form");if(this._parentForm&&window.external&&"AutoCompleteSaveForm"in window.external){window.external.AutoCompleteSaveForm(this.Y.Node.getDOMNode(this._parentForm));}}
var searchPage=this.data.attrs.report_page_url;this.searchSource().fire("search",new RightNow.Event.EventObject(this,{filters:{report_id:this.data.attrs.report_id,source_id:this.data.attrs.source_id,reportPage:searchPage,newPage:this.data.attrs.force_page_flip||top!==self||(searchPage!==""&&searchPage!=="{current_page}"&&!RightNow.Url.isSameUrl(searchPage)),target:this.data.attrs.target,popupWindow:this.data.attrs.popup_window,width:this.data.attrs.popup_window_width_percent,height:this.data.attrs.popup_window_height_percent}}));},_enableClickListener:function(){if(this._requestInProgress){this._searchButton.on("click",this._startSearch,this);}
this._requestInProgress=false;},_disableClickListener:function(){this._requestInProgress=true;this._searchButton.detach("click",this._startSearch);}});
RightNow.Widgets.SearchTypeList=RightNow.SearchFilter.extend({overrides:{constructor:function(){this.parent();this._selectBox=this.Y.one(this.baseSelector+"_Options");if(!this._selectBox)
return;this._eo=new RightNow.Event.EventObject(this);this._selectBox.on("change",this._onSelectChange,this);this.searchSource().on("searchTypeChanged",this._onChangedResponse,this).on("search",function(){return this._eo;},this).on("reset",this._onResetRequest,this);this.searchSource(this.data.attrs.report_id).on("response",this._onChangedResponse,this);this._setFilter();this._setSelectedDropdownItem(this.data.js.defaultFilter);}},_onSelectChange:function()
{this._setSelected();this.searchSource().fire("searchTypeChanged",this._eo);if(this.data.attrs.search_on_select)
{this._eo.filters.reportPage=this.data.attrs.report_page_url;this.searchSource().fire("search",this._eo);}},_setSelectedDropdownItem:function(valueToSelect)
{this._selectBox.get("options").each(function(option,i){if(parseInt(option.get("value"),10)===valueToSelect){this._selectBox.set("selectedIndex",i);return;}},this);},_setSelected:function()
{var selectedOption=this._selectBox.get('options').item(this._selectBox.get('selectedIndex')),value=parseInt(selectedOption.get('value'),10),label=selectedOption.get('text'),node;for(node in this.data.js.filters)
{if(this.data.js.filters[node].fltr_id===value)
{this._setSelectedFilter(this.data.js.filters[node],label);}}},_setSelectedFilter:function(selected,label)
{this._eo.filters.fltr_id=selected.fltr_id;this._eo.filters.data={"val":selected.fltr_id};this._eo.filters.data.label=label;this._eo.filters.oper_id=selected.oper_id;},_setFilter:function()
{this._eo.filters={"rnSearchType":this.data.js.rnSearchType,"searchName":this.data.js.searchName,"report_id":this.data.attrs.report_id};for(var node in this.data.js.filters)
{if(this.data.js.filters[node].fltr_id===this.data.js.defaultFilter)
{this._setSelectedFilter(this.data.js.filters[node],this.data.js.filters[node].prompt);break;}}},_onResetRequest:function(type,args)
{if(RightNow.Event.isSameReportID(args,this.data.attrs.report_id))
{if(args[0].data.name===this.data.js.searchName){this._setSelectedDropdownItem(this.data.js.resetFilter);this._setSelected();}
else if(args[0].data.name==='all'){this._setSelectedDropdownItem(this.data.js.defaultFilter);this._setSelected();}}},_onChangedResponse:function(type,args)
{if(RightNow.Event.isSameReportID(args,this.data.attrs.report_id))
{var data=RightNow.Event.getDataFromFiltersEventResponse(args,this.data.js.searchName,this.data.attrs.report_id);this._setSelectedDropdownItem(((data&&data.val)?data.val:this.data.js.defaultFilter));this._setSelected();}}});
RightNow.Widgets.WebSearchSort=RightNow.SearchFilter.extend({overrides:{constructor:function(){this.parent();this._searchName="webSearchSort";this._optionsSelect=this.Y.one(this.baseSelector+"_Options");if(!this._optionsSelect)
return;this.searchSource().on("webSearchSortChanged",this._onChangedResponse,this).on("search",function(){return this._eo;},this).on("reset",this._onReset,this);this.searchSource(this.data.attrs.report_id).on("response",this._onChangedResponse,this);this._optionsSelect.on("change",this._onSortChange,this);this._setFilter();}},_setFilter:function()
{this._eo=new RightNow.Event.EventObject(this,{filters:{searchName:this._searchName,report_id:this.data.js.report_id}});this._setDataObject();},_setDataObject:function()
{this._eo.filters.data={"col_id":(this.data.js.sortDefault!=this.data.js.configDefault)?this.data.js.sortDefault:null,"sort_direction":1,"sort_order":1};},_setSelected:function()
{var num=this._optionsSelect.get('selectedIndex');if(this._optionsSelect.get('options').item(num))
{this._eo.filters.data.col_id=this._optionsSelect.get('options').item(num).get('value');}},_setSelectedDropdownItem:function(valueToSelect)
{this._optionsSelect.get('options').each(function(option,i){if(parseInt(option.get('value'),10)===valueToSelect)
{this._optionsSelect.set('selectedIndex',i);}},this);},_onSortChange:function()
{this._setSelected();this.searchSource().fire("webSearchSortChanged",this._eo);},_onChangedResponse:function(type,args)
{if(RightNow.Event.isSameReportID(args,this.data.attrs.report_id))
{var data=RightNow.Event.getDataFromFiltersEventResponse(args,this._searchName,this.data.attrs.report_id);var newValue=(!data||data.col_id===null)?this.data.js.sortDefault:data.col_id;if(this._eo.filters.data===null)
this._setDataObject();this._setSelectedDropdownItem(newValue);this._setSelected();}},_onReset:function(type,args)
{if(RightNow.Event.isSameReportID(args,this.data.attrs.report_id)&&(args[0].data.name===this._searchName||args[0].data.name==="all"))
{this._setSelectedDropdownItem(this.data.js.sortDefault);this._setDataObject();}}});
RightNow.Widgets.WebSearchType=RightNow.SearchFilter.extend({overrides:{constructor:function(){this.parent();this._optionsSelect=this.Y.one(this.baseSelector+"_Options");this._searchName="webSearchType";if(!this._optionsSelect)
return;this.searchSource().on("webSearchTypeChanged",this._onChangedResponse,this).on("search",function(){return this._eo;},this).on("reset",this._onReset,this);this.searchSource(this.data.attrs.report_id).on("response",this._onChangedResponse,this);this._optionsSelect.on("change",this._onSearchChange,this);this._eo=new RightNow.Event.EventObject(this,{filters:{searchName:this._searchName,report_id:this.data.js.report_id}});this._setFilter();}},_setFilter:function()
{this._eo.filters.data=this.data.js.searchDefault;},_setSelected:function()
{var num=this._optionsSelect.get('selectedIndex');if(this._optionsSelect.get('options').item(num))
{this._eo.filters.data=this._optionsSelect.get('options').item(num).get('value');}},_setSelectedDropdownItem:function(valueToSelect)
{this._optionsSelect.get('options').each(function(option,i){if(parseInt(option.get('value'),10)===valueToSelect)
{this._optionsSelect.set('selectedIndex',i);}},this);},_onSearchChange:function(evt)
{this._setSelected();this.searchSource().fire("webSearchTypeChanged",this._eo);},_onChangedResponse:function(type,args)
{if(RightNow.Event.isSameReportID(args,this.data.attrs.report_id))
{var data=RightNow.Event.getDataFromFiltersEventResponse(args,this._searchName,this.data.attrs.report_id);var newValue=(!data)?this.data.js.searchDefault:data;this._setSelectedDropdownItem(newValue);this._setSelected();}},_onReset:function(type,args)
{if(RightNow.Event.isSameReportID(args,this.data.attrs.report_id)&&(args[0].data.name===this._searchName||args[0].data.name==="all"))
{this._setSelectedDropdownItem(this.data.js.searchDefault);this._setFilter();}}});
RightNow.Widgets.ProductCategorySearchFilter=RightNow.SearchFilter.extend({overrides:{constructor:function(){this.parent();this.Y.augment(this,RightNow.ProductCategory);this._getFiltersRequest.lastInstance=this._getFiltersRequest.lastInstance||{};this.searchSource(this.data.attrs.report_id).on('search',this._getFiltersRequest,this).on('response',this._onReportResponse,this).on('reset',this._onResetRequest,this);this._initializeFilter();this.initializeTreeView(this.data.attrs.filter_type);}},selectNode:function(node){if(node!==null){this._getFiltersRequest.lastInstance[this.data.attrs.filter_type]=this.baseDomID;if((node.expanded||!node.value)&&!this.data.js.linkingOn){this._eo.data.level=node.depth+1;if(this._eo.data.level!==this._eo.filters.data[0].length){this._eo.filters.data[0]=node.valueChain;}
else{this._eo.filters.data[0][this._eo.data.level-1]=node.value||this._eo.data.value;for(var i=this._eo.data.level;i<this._eo.filters.data[0].length;i++)
delete this._eo.filters.data[0][i];}}
else if(this.data.attrs.search_on_select&&!RightNow.Url.isSameUrl(this.data.attrs.report_page_url)){this._eo.data.level=node.depth+1;this._eo.data.label=node.label;this._eo.data.value=node.value;this._eo.filters.data[0][node.depth]=node.value;}
else{this.getSubLevelRequest(node);this.tree.collapseAll();}
RightNow.ProductCategory.prototype.selectNode.call(this,node);if(this.data.attrs.search_on_select){this._eo.filters.reportPage=this.data.attrs.report_page_url;this.searchSource().fire('search',this._eo);}}},getSubLevelRequestEventObject:function(expandingNode){if(expandingNode.expanded&&!this.data.js.linkingOn)return;this._eo.data.level=expandingNode.depth+1;this._eo.data.label=expandingNode.label;this._eo.data.value=expandingNode.value;this.getSubLevelRequestEventObject._origRequest=this.getSubLevelRequestEventObject._origRequest||[];this.getSubLevelRequestEventObject._origRequest[this._dataType]=expandingNode.value;if(this.data.js.link_map){this._eo.data.link_map=this.data.js.link_map;this.data.js.link_map=null;}
if(this._eo.data.level!==this._eo.filters.data[0].length){this._eo.filters.data[0]=this.tree.get('valueChain');}
else{this._eo.filters.data[0][this._eo.data.level-1]=this._eo.data.value;for(var i=this._eo.data.level;i<this._eo.filters.data[0].length;i++)
delete this._eo.filters.data[0][i];}
if(!expandingNode.loaded||this.data.js.linkingOn)
return this._eo;},getSubLevelResponse:function(type,args){var eventObject=args[0];if(!((eventObject.data.linking_on&&((!eventObject.data.value&&eventObject.data.via_hier_request)||(eventObject.data.via_product_click)))||(eventObject.data.data_type!==this._dataType)||(eventObject.filters.report_id!==this.data.attrs.report_id))){RightNow.ProductCategory.prototype.getSubLevelResponse.call(this,eventObject,this._dataType);}},_onReportResponse:function(type,args){var data=RightNow.Event.getDataFromFiltersEventResponse(args,this.data.js.searchName);this._getFiltersRequest.cachedWidgetHier={};if(data[0]&&data[0].length){this.buildTree();if(typeof data[0]==="string")
data[0]=data[0].split(",");var finalData=RightNow.Lang.arrayFilter(data[0]);this.tree.expandAndCreateNodes(finalData);if(this.data.attrs.show_confirm_button_in_dialog){this.dropdown.fire('confirm');}
this._eo.filters.data[0]=finalData;this._lastSearchValue=finalData.slice(0);if(this._eo.filters.data.reconstructData){this._eo.filters.data.level=this._eo.filters.data.reconstructData.level;this._eo.filters.data.label=this._eo.filters.data.reconstructData.label;}}
else{this._eo.filters.data[0]=[];if(this.tree){this.tree.resetSelectedNode();this.displaySelectedNodesAndClose();}}},_getFiltersRequest:function(type,args){this._getFiltersRequest.lastInstance[this.data.attrs.filter_type]=this._getFiltersRequest.lastInstance[this.data.attrs.filter_type]||null;this._getFiltersRequest.cachedWidgetHier=this._getFiltersRequest.cachedWidgetHier||{};var filterName=(this._eo.filters.searchName||"")+this.data.attrs.report_id,filterKey=filterName+this.baseDomID,mostRecentFilterKey=filterName+this._getFiltersRequest.lastInstance[this.data.attrs.filter_type],cachedHier=this._getFiltersRequest.cachedWidgetHier[mostRecentFilterKey];this._eo.filters.data.reconstructData=[];if(this.tree&&this.tree.get('value')){this._eo.data.level=this.tree.get('depth');this._eo.data.label=this.tree.get('label');this._eo.data.value=this.tree.get('value');var labelChain=this.tree.get('labelChain');for(var i=0;i<labelChain.length;i++){this._eo.filters.data.reconstructData.push({level:i+1,label:labelChain[i],hierList:this._eo.filters.data[0].slice(0,i+1).join(",")});}
if(cachedHier&&filterKey!==mostRecentFilterKey){this._eo.filters.data=cachedHier;}
else{this._getFiltersRequest.cachedWidgetHier[filterKey]=RightNow.Lang.cloneObject(this._eo.filters.data);}}
else if(cachedHier){this._eo.filters.data=cachedHier;this._eo.data.value=cachedHier[0][0];}
else{this._eo.filters.data[0]=[];this._eo.data.value=0;}
this._lastSearchValue=this._eo.filters.data[0].slice(0);return this._eo;},_onResetRequest:function(type,args){args=args[0];if(this.tree&&(!args||args.data.name==='all'||args.data.name===this.data.js.searchName)){if(args&&args.data.name==="all"&&this._lastSearchValue){this._eo.filters.data[0]=this._lastSearchValue;}
else{if(args&&args.data.reset&&this.data.js.linkingOn&&this._dataType==="Category"){RightNow.Event.fire('evt_resetFilterRequest',args);if(this.data.js.link_map)
delete this.data.js.link_map;this.buildTree(true);}
if(!args)
this._eo.filters.data=[(this.data.js.initial)?this.data.js.initial:[]];else
this._eo.filters.data[0]=[];this._lastSearchValue=this._eo.filters.data[0].slice(0);this._getFiltersRequest.cachedWidgetHier={};}
this.tree.selectNodeWithValue(this._lastSearchValue[this._lastSearchValue.length-1]||0);this.displaySelectedNodesAndClose();}},_initializeFilter:function(){this._eo=new RightNow.Event.EventObject(this,{data:{data_type:this._dataType=this.data.attrs.filter_type,linking_on:this.data.js.linkingOn,cache:[],hm_type:this.data.js.hm_type,linkingProduct:0},filters:{rnSearchType:"menufilter",searchName:this.data.js.searchName,report_id:this.data.attrs.report_id,fltr_id:this.data.js.fltr_id,oper_id:this.data.js.oper_id,data:[(this.data.js.initial)?this.data.js.initial:[]]}});this._lastSearchValue=this._eo.filters.data[0].slice(0);if(this._dataType==="Product"){RightNow.UI.Form.currentProduct=this._eo.filters.data[0][this._eo.filters.data[0].length-1];}}});
RightNow.Widgets.FilterDropdown=RightNow.SearchFilter.extend({overrides:{constructor:function(){this.parent();this._eo=new RightNow.Event.EventObject(this);this._selectBox=this.Y.one(this.baseSelector+"_Options");this._selectBox.on("change",this._onSelectChange,this);this.searchSource().on("search",function(){return this._eo;},this).on("reset",this._onResetRequest,this);this.searchSource(this.data.attrs.report_id).on("response",this._onChangedResponse,this);this._setSelectedDropdownItem(this.data.js.defaultValue);this._setFilter();this.lastValue=this._eo.filters.data.val;}},_onSelectChange:function()
{this.lastValue=this._eo.filters.data.val;this._eo.filters.data.val=this._getSelected();if(this.data.attrs.search_on_select)
{this._eo.filters.reportPage=this.data.attrs.report_page_url;this.searchSource().fire("search",this._eo);}},_getSelected:function()
{return this._selectBox.get('options').item(this._selectBox.get('selectedIndex')).get('value');},_setSelectedDropdownItem:function(valueToSelect)
{this._selectBox.get("options").each(function(option,i){if(option.get("value")===(valueToSelect+'')){this._selectBox.set("selectedIndex",i);return;}},this);},_setFilter:function()
{this._eo.filters={"searchName":this.data.js.searchName,"rnSearchType":this.data.js.rnSearchType,"report_id":this.data.attrs.report_id,"data":{"fltr_id":this.data.js.filters.fltr_id,"oper_id":this.data.js.filters.oper_id,"val":this._getSelected()}};},_onChangedResponse:function(type,args)
{var data=RightNow.Event.getDataFromFiltersEventResponse(args,this.data.js.searchName,this.data.attrs.report_id),newValue=this._eo.filters.data.val,allFilters;if(data&&data.fltr_id===this.data.js.filters.fltr_id){newValue=data.val||this.data.js.defaultValue;}
else if(RightNow.Event.isSameReportID(args,this.data.attrs.report_id)){allFilters=args[0].filters.allFilters[this.data.js.searchName];if(!allFilters){newValue=this.data.js.defaultValue;}}
if(newValue!==this._eo.filters.data.val){this._setSelectedDropdownItem(newValue);this._eo.filters.data.val=this.lastValue=newValue;}},_onResetRequest:function(type,args)
{var resetValue=this._eo.filters.data.val;if(RightNow.Event.isSameReportID(args,this.data.attrs.report_id)&&(args[0].data.name===this.data.js.searchName||args[0].data.name==="all"))
{if(args[0].data.name===this.data.js.searchName){resetValue=this.lastValue=this.data.js.defaultValue;}
else if(args[0].data.name==='all'){resetValue=this.lastValue||resetValue;}
if(resetValue!==this._eo.filters.data.val){this._setSelectedDropdownItem(resetValue);this._eo.filters.data.val=resetValue;}}}});
RightNow.Widgets.SortList=RightNow.SearchFilter.extend({overrides:{constructor:function(){this.parent();this._headingsSelect=this.Y.one(this.baseSelector+"_Headings");this._directionSelect=this.Y.one(this.baseSelector+"_Direction");RightNow.Event.on("evt_sortChange",this._onResponse,this);this.searchSource().on("search",this._onSearch,this).on("reset",this._onReset,this);this.searchSource(this.data.attrs.report_id).on("response",this._onResponse,this);this._setFilter();this._setSelectedDropdownItem(this._headingsSelect,this.data.js.col_id);this._setSelectedDropdownItem(this._directionSelect,this.data.js.sort_direction);this._headingsSelect.on("change",this._onChange,this,"column");this._directionSelect.on("change",this._onChange,this,"direction");}},_onChange:function(evt,dropdownThatChanged){this._setEventObjectFromUI(dropdownThatChanged);RightNow.Event.fire("evt_sortChange",this._eo);if(this.data.attrs.search_on_select){this._eo.filters.reportPage=this.data.attrs.report_page_url;this.searchSource().fire("search",this._eo);}},_setEventObjectFromUI:function(dropdownThatChanged){var selectBox,memberToSet,index;if(dropdownThatChanged==="direction"){selectBox=this._directionSelect;memberToSet="sort_direction";}
else{selectBox=this._headingsSelect;memberToSet="col_id";}
if(selectBox){index=selectBox.get("selectedIndex");index=(index>0)?index:0;this._eo.filters.data[memberToSet]=parseInt(selectBox.get("options").item(index).get("value"),10);}},_setSelectedDropdownItem:function(selectBox,valueToSelect){if(selectBox){selectBox.get("options").each(function(option,i){if(parseInt(option.get("value"),10)===valueToSelect){selectBox.set("selectedIndex",i);return true;}});}
return false;},_setFilter:function(){this._eo=new RightNow.Event.EventObject(this,{filters:{searchName:this.data.js.searchName,report_id:this.data.attrs.report_id,data:this._getDataObject()}});},_getDataObject:function(){return{col_id:this.data.js.col_id,sort_direction:this.data.js.sort_direction};},_onResponse:function(name,args){if(args[0].w_id===this.instanceID)return;var data=RightNow.Event.getDataFromFiltersEventResponse(args,this.data.js.searchName,this.data.attrs.report_id);if(this._eo.filters.data===null){this._eo.filters.data=this._getDataObject();}
this._setSelectedDropdownItem(this._headingsSelect,((!data||data.col_id==null)?this.data.js.col_id:data.col_id));this._setEventObjectFromUI("column");this._setSelectedDropdownItem(this._directionSelect,((!data||data.sort_direction==null)?this.data.js.sort_direction:data.sort_direction));this._setEventObjectFromUI("direction");},_onReset:function(type,args){if(!args[0]||args[0].data.name===this.data.js.searchName||args[0].data.name==="all"){this._setSelectedDropdownItem(this._headingsSelect,this.data.js.col_id);this._setSelectedDropdownItem(this._directionSelect,this.data.js.sort_direction);this._setFilter();}},_onSearch:function(type,args){return this._eo;}});